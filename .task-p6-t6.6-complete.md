# P6-T6.6: ì»¤ë®¤ë‹ˆí‹° íƒ€ì… ì •ì˜ - ì™„ë£Œ

## ğŸ“¦ ìƒì„±ëœ íŒŒì¼

### íƒ€ì… ì •ì˜ íŒŒì¼ (src/types/)

1. **review.ts** (141 lines)
   - Review ê¸°ë³¸ íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
   - ReviewWithAuthor, ReviewWithProduct í™•ì¥ íƒ€ì…
   - CreateReviewInput, UpdateReviewInput ì…ë ¥ ìŠ¤í‚¤ë§ˆ
   - ReviewFilter, ReviewStats ìŠ¤í‚¤ë§ˆ
   - ë³„ì  1-5 ê²€ì¦, ì´ë¯¸ì§€ ìµœëŒ€ 5ì¥ ì œí•œ
   - ì •ë ¬ ì˜µì…˜ (ìµœì‹ ìˆœ/ë³„ì ìˆœ/ì¢‹ì•„ìš”ìˆœ)

2. **inquiry.ts** (167 lines)
   - Inquiry ê¸°ë³¸ íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
   - InquiryWithAuthor, InquiryWithProduct, InquiryWithAnswer í™•ì¥ íƒ€ì…
   - CreateInquiryInput, UpdateInquiryInput, AnswerInquiryInput ìŠ¤í‚¤ë§ˆ
   - InquiryFilter, InquiryStats ìŠ¤í‚¤ë§ˆ
   - ì¹´í…Œê³ ë¦¬ íƒ€ì… (product/shipping/refund/etc)
   - ìƒíƒœ íƒ€ì… (pending/answered)
   - ë¹„ë°€ê¸€ ì˜µì…˜ ì§€ì›

3. **comment.ts** (169 lines)
   - Comment ê¸°ë³¸ íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
   - CommentWithAuthor, CommentWithReplies í™•ì¥ íƒ€ì…
   - Like ê¸°ë³¸ íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
   - CreateCommentInput, UpdateCommentInput, ToggleLikeInput ìŠ¤í‚¤ë§ˆ
   - ë‹¤í˜•ì„± ì§€ì› (commentable_type: review/inquiry)
   - ë‹¤í˜•ì„± ì¢‹ì•„ìš” (likeable_type: review/comment)
   - 1ë‹¨ê³„ ëŒ€ëŒ“ê¸€ë§Œ í—ˆìš© (MAX_COMMENT_DEPTH = 1)

4. **index.ts** (ì—…ë°ì´íŠ¸)
   - ëª¨ë“  ì»¤ë®¤ë‹ˆí‹° íƒ€ì… re-export
   - ê¸°ì¡´ íƒ€ì…ê³¼ì˜ ì¶©ëŒ ë°©ì§€ ì²˜ë¦¬

### í…ŒìŠ¤íŠ¸ íŒŒì¼ (tests/types/)

5. **community.test.ts** (467 lines)
   - Review íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸ (9ê°œ)
   - Inquiry íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸ (7ê°œ)
   - Comment íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸ (6ê°œ)
   - Like íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸ (5ê°œ)
   - ì´ **27ê°œ í…ŒìŠ¤íŠ¸**, ëª¨ë‘ í†µê³¼ âœ…

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### Review (ìƒí’ˆ í›„ê¸°)
- âœ… êµ¬ë§¤ìë§Œ ì‘ì„± ê°€ëŠ¥ (order_item_id ê²€ì¦)
- âœ… ë³„ì  1-5 í•„ìˆ˜
- âœ… ì´ë¯¸ì§€ ìµœëŒ€ 5ì¥
- âœ… ì¢‹ì•„ìš”/ì¡°íšŒìˆ˜ ê¸°ëŠ¥
- âœ… ë² ìŠ¤íŠ¸ í›„ê¸° í”Œë˜ê·¸
- âœ… í‰ê·  ë³„ì  ë° ë¶„í¬ í†µê³„

### Inquiry (ìƒí’ˆ ë¬¸ì˜)
- âœ… ì¹´í…Œê³ ë¦¬ë³„ ë¶„ë¥˜ (ìƒí’ˆ/ë°°ì†¡/í™˜ë¶ˆ/ê¸°íƒ€)
- âœ… ë¹„ë°€ê¸€ ì˜µì…˜ (is_private)
- âœ… ë‹µë³€ ìƒíƒœ ê´€ë¦¬ (pending/answered)
- âœ… ê´€ë¦¬ì ë‹µë³€ ê¸°ëŠ¥
- âœ… ë‹µë³€ í…œí”Œë¦¿ ì§€ì›

### Comment & Like (ëŒ“ê¸€/ì¢‹ì•„ìš”)
- âœ… ë‹¤í˜•ì„± ëŒ“ê¸€ (reviews, inquiries ê³µìš©)
- âœ… 1ë‹¨ê³„ ëŒ€ëŒ“ê¸€ (parent_id)
- âœ… ë‹¤í˜•ì„± ì¢‹ì•„ìš” (reviews, comments ê³µìš©)
- âœ… ì¢‹ì•„ìš” í† ê¸€ ê¸°ëŠ¥
- âœ… ì¢‹ì•„ìš” ìˆ˜ ìºì‹±

## ğŸ“Š Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦

ëª¨ë“  íƒ€ì…ì— ëŒ€í•´ ë‹¤ìŒ ê²€ì¦ ì ìš©:

### Review
- `rating`: 1-5 ë²”ìœ„ ê²€ì¦
- `title`: ìµœì†Œ 1ì, ìµœëŒ€ 200ì
- `content`: ìµœì†Œ 10ì
- `images`: ìµœëŒ€ 5ê°œ URL ë°°ì—´

### Inquiry
- `category`: enum ê²€ì¦ (product/shipping/refund/etc)
- `status`: enum ê²€ì¦ (pending/answered)
- `title`: ìµœì†Œ 1ì, ìµœëŒ€ 200ì
- `content`: ìµœì†Œ 10ì

### Comment
- `commentable_type`: enum ê²€ì¦ (review/inquiry)
- `content`: ìµœì†Œ 1ì, ìµœëŒ€ 1000ì
- `parent_id`: nullable (ëŒ€ëŒ“ê¸€ìš©)

### Like
- `likeable_type`: enum ê²€ì¦ (review/comment)
- `is_liked`: boolean
- `like_count`: ìŒìˆ˜ ë¶ˆê°€

## ğŸ”— ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™

ë‹¤ìŒ í…Œì´ë¸”ê³¼ ë§¤í•‘:
- `reviews` â†’ ReviewSchema
- `inquiries` â†’ InquirySchema
- `comments` â†’ CommentSchema
- `likes` â†’ LikeSchema

RLS ì •ì±… ë° íŠ¸ë¦¬ê±° ì§€ì›:
- í›„ê¸°: êµ¬ë§¤ìë§Œ ì‘ì„±, ë³¸ì¸ë§Œ ìˆ˜ì •/ì‚­ì œ
- ë¬¸ì˜: ë¹„ë°€ê¸€ ì ‘ê·¼ ì œì–´ (ë³¸ì¸/ê´€ë¦¬ì)
- ëŒ“ê¸€: ë³¸ì¸ë§Œ ìˆ˜ì •/ì‚­ì œ
- ì¢‹ì•„ìš”: ì¤‘ë³µ ë°©ì§€, ìë™ ì¹´ìš´íŠ¸ ë™ê¸°í™”

## ğŸ“ˆ í…ŒìŠ¤íŠ¸ ê²°ê³¼

```bash
npm test -- tests/types/community.test.ts
```

```
âœ“ tests/types/community.test.ts (27 tests) 8ms
  Test Files  1 passed (1)
  Tests  27 passed (27)
  Duration  2.70s
```

## ğŸš€ ì‚¬ìš© ì˜ˆì‹œ

### Review ìƒì„±
```typescript
import { CreateReviewSchema } from '@/types/review';

const input = {
  product_id: '...',
  order_item_id: '...',
  rating: 5,
  title: 'í›Œë¥­í•œ ìƒí’ˆì…ë‹ˆë‹¤',
  content: 'ë§¤ìš° ë§Œì¡±ìŠ¤ëŸ½ìŠµë‹ˆë‹¤. ì¬êµ¬ë§¤ ì˜ì‚¬ 100%!',
  images: ['https://...'],
};

const validated = CreateReviewSchema.parse(input);
```

### Inquiry ìƒì„±
```typescript
import { CreateInquirySchema } from '@/types/inquiry';

const input = {
  product_id: '...',
  category: 'product',
  title: 'ì‚¬ì´ì¦ˆ ë¬¸ì˜',
  content: 'ì‹¤ì œ í¬ê¸°ê°€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?',
  is_private: true,
};

const validated = CreateInquirySchema.parse(input);
```

### Comment ìƒì„±
```typescript
import { CreateCommentSchema } from '@/types/comment';

const input = {
  commentable_type: 'review',
  commentable_id: '...',
  parent_id: null, // ëŒ“ê¸€ (ëŒ€ëŒ“ê¸€ì´ë©´ ë¶€ëª¨ ID)
  content: 'ìœ ìµí•œ í›„ê¸° ê°ì‚¬í•©ë‹ˆë‹¤!',
};

const validated = CreateCommentSchema.parse(input);
```

### Like í† ê¸€
```typescript
import { ToggleLikeSchema } from '@/types/comment';

const input = {
  likeable_type: 'review',
  likeable_id: '...',
};

const validated = ToggleLikeSchema.parse(input);
```

## âœ… ì™„ë£Œ ì¡°ê±´

- [x] src/types/review.ts - Review íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
- [x] src/types/inquiry.ts - Inquiry íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
- [x] src/types/comment.ts - Comment, Like íƒ€ì… ë° Zod ìŠ¤í‚¤ë§ˆ
- [x] tests/types/community.test.ts - íƒ€ì… ê²€ì¦ í…ŒìŠ¤íŠ¸ (27ê°œ í†µê³¼)
- [x] vitest ì„¤ì¹˜ ë° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ í™˜ê²½ êµ¬ì„±
- [x] ëª¨ë“  íƒ€ì…ì— Zod ìŠ¤í‚¤ë§ˆ í¬í•¨
- [x] ì •ë ¬ ì˜µì…˜, í•„í„°, í†µê³„ íƒ€ì… ì •ì˜
- [x] ë‹¤í˜•ì„± íƒ€ì… ì„¤ê³„ (commentable, likeable)
- [x] 1ë‹¨ê³„ ëŒ€ëŒ“ê¸€ ì œí•œ (MAX_COMMENT_DEPTH = 1)

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

ì´ì œ ë‹¤ìŒ íƒœìŠ¤í¬ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- **P6-T6.2**: í›„ê¸° API êµ¬í˜„ (tests/api/reviews.test.ts â†’ app/api/reviews/route.ts)
- **P6-T6.3**: ë¬¸ì˜ API êµ¬í˜„ (tests/api/inquiries.test.ts â†’ app/api/inquiries/route.ts)
- **P6-T6.4**: ëŒ“ê¸€ API êµ¬í˜„ (tests/api/comments.test.ts â†’ app/api/comments/route.ts)
- **P6-T6.5**: ì¢‹ì•„ìš” API êµ¬í˜„ (tests/api/likes.test.ts â†’ app/api/likes/route.ts)

## ğŸ” í’ˆì§ˆ í™•ì¸

- âœ… TypeScript íƒ€ì… ì•ˆì •ì„±: ëª¨ë“  íƒ€ì…ì— Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦
- âœ… í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€: 27ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼
- âœ… ë°ì´í„° ê²€ì¦: ìµœì†Œ/ìµœëŒ€ ê¸¸ì´, enum, ë²”ìœ„ ê²€ì¦
- âœ… ì—ëŸ¬ ë©”ì‹œì§€: í•œê¸€ ì—ëŸ¬ ë©”ì‹œì§€ (ì‚¬ìš©ì ì¹œí™”ì )
- âœ… ë¬¸ì„œí™”: JSDoc ì£¼ì„ ë° íƒ€ì… ì„¤ëª… í¬í•¨
- âœ… í™•ì¥ì„±: ë‹¤í˜•ì„± ì„¤ê³„ë¡œ í–¥í›„ í™•ì¥ ìš©ì´
