# P6-T6.1: ì»¤ë®¤ë‹ˆí‹° DB ìŠ¤í‚¤ë§ˆ ì™„ë£Œ ë³´ê³ ì„œ

**Task ID**: P6-T6.1
**Phase**: 6 (Community Features)
**Worktree**: worktree/phase-6-community
**Status**: âœ… COMPLETED
**Date**: 2026-01-25

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ìƒí’ˆ í›„ê¸°, ë¬¸ì˜, ëŒ“ê¸€, ì¢‹ì•„ìš” ì‹œìŠ¤í…œì„ ìœ„í•œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìƒì„±

### ì‚°ì¶œë¬¼

1. **008_create_reviews.sql** (187 lines)
   - reviews í…Œì´ë¸” ìƒì„±
   - RLS ì •ì±… (5ê°œ)
   - í—¬í¼ í•¨ìˆ˜ (3ê°œ)
   - 7ê°œ ì¸ë±ìŠ¤

2. **009_create_inquiries.sql** (224 lines)
   - inquiries í…Œì´ë¸” ìƒì„±
   - RLS ì •ì±… (5ê°œ)
   - í—¬í¼ í•¨ìˆ˜ (3ê°œ)
   - ìë™ ìƒíƒœ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
   - 7ê°œ ì¸ë±ìŠ¤

3. **010_create_comments_likes.sql** (366 lines)
   - comments, likes í…Œì´ë¸” ìƒì„± (ë‹¤í˜•ì„± ì§€ì›)
   - RLS ì •ì±… (8ê°œ: comments 5ê°œ, likes 3ê°œ)
   - í—¬í¼ í•¨ìˆ˜ (4ê°œ)
   - ì¢‹ì•„ìš” ìˆ˜ ìë™ ë™ê¸°í™” íŠ¸ë¦¬ê±° (5ê°œ)
   - 8ê°œ ì¸ë±ìŠ¤

---

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### 1. ìƒí’ˆ í›„ê¸° ì‹œìŠ¤í…œ (reviews)

#### í…Œì´ë¸” êµ¬ì¡°
```sql
reviews (
  id UUID PRIMARY KEY,
  product_id UUID NOT NULL,           -- ìƒí’ˆ
  user_id UUID NOT NULL,              -- ì‘ì„±ì
  order_item_id UUID NOT NULL UNIQUE, -- êµ¬ë§¤ ê²€ì¦ (1ì£¼ë¬¸ë‹¹ 1í›„ê¸°)
  rating INTEGER CHECK (1-5),         -- ë³„ì 
  title VARCHAR(200),                 -- í›„ê¸° ì œëª©
  content TEXT,                       -- í›„ê¸° ë‚´ìš©
  images JSONB DEFAULT '[]',          -- ì´ë¯¸ì§€ ë°°ì—´ (ìµœëŒ€ 5ì¥)
  like_count INTEGER DEFAULT 0,       -- ì¢‹ì•„ìš” ìˆ˜ (ìºì‹œ)
  view_count INTEGER DEFAULT 0,       -- ì¡°íšŒìˆ˜
  is_best BOOLEAN DEFAULT false,      -- ë² ìŠ¤íŠ¸ í›„ê¸° (ê´€ë¦¬ì ì„ ì •)
  created_at, updated_at
)
```

#### í•µì‹¬ ì •ì±…
- âœ… **êµ¬ë§¤ì ê²€ì¦**: order_item_idë¡œ ì‹¤ì œ êµ¬ë§¤ìë§Œ í›„ê¸° ì‘ì„± ê°€ëŠ¥
- âœ… **1ì£¼ë¬¸ë‹¹ 1í›„ê¸°**: UNIQUE ì œì•½ìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€
- âœ… **ë³„ì  ë²”ìœ„**: CHECK ì œì•½ìœ¼ë¡œ 1-5 ë²”ìœ„ ê°•ì œ
- âœ… **ë² ìŠ¤íŠ¸ í›„ê¸°**: ê´€ë¦¬ìë§Œ is_best í”Œë˜ê·¸ ì„¤ì • ê°€ëŠ¥

#### í—¬í¼ í•¨ìˆ˜
```sql
-- ì¡°íšŒìˆ˜ ì¦ê°€ (RLS ìš°íšŒ)
increment_review_view_count(review_id UUID)

-- ìƒí’ˆ í‰ê·  ë³„ì  ê³„ì‚°
get_product_average_rating(product_id UUID) RETURNS NUMERIC

-- ë³„ì ë³„ ê°œìˆ˜ ì§‘ê³„ (5ì : 10ê°œ, 4ì : 5ê°œ ...)
get_product_rating_distribution(product_id UUID) RETURNS TABLE(rating, count)
```

---

### 2. ìƒí’ˆ ë¬¸ì˜ ì‹œìŠ¤í…œ (inquiries)

#### í…Œì´ë¸” êµ¬ì¡°
```sql
inquiries (
  id UUID PRIMARY KEY,
  product_id UUID,                    -- ìƒí’ˆ (NULL ê°€ëŠ¥: ì¼ë°˜ ë¬¸ì˜)
  user_id UUID NOT NULL,              -- ì‘ì„±ì
  category VARCHAR(50),               -- product/shipping/payment/etc
  title VARCHAR(200),
  content TEXT,
  is_private BOOLEAN DEFAULT false,   -- ë¹„ë°€ê¸€ ì—¬ë¶€
  status VARCHAR(20) DEFAULT 'pending', -- pending/answered
  answer TEXT,                        -- ê´€ë¦¬ì ë‹µë³€
  answered_by UUID,                   -- ë‹µë³€ì
  answered_at TIMESTAMPTZ,            -- ë‹µë³€ ì‹œê°„
  view_count INTEGER DEFAULT 0,
  created_at, updated_at
)
```

#### í•µì‹¬ ì •ì±…
- âœ… **ë¹„ë°€ê¸€ ë³´í˜¸**: is_private = trueì¼ ë•Œ ì‘ì„±ì/ê´€ë¦¬ìë§Œ ì¡°íšŒ ê°€ëŠ¥
- âœ… **ë‹µë³€ ì „ ìˆ˜ì •**: status = 'pending'ì¼ ë•Œë§Œ ì‘ì„±ìê°€ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
- âœ… **ìë™ ìƒíƒœ ë³€ê²½**: ë‹µë³€ ì‘ì„± ì‹œ status ìë™ 'answered'ë¡œ ë³€ê²½ (íŠ¸ë¦¬ê±°)
- âœ… **ì¹´í…Œê³ ë¦¬ ê²€ì¦**: CHECK ì œì•½ìœ¼ë¡œ í—ˆìš©ëœ ì¹´í…Œê³ ë¦¬ë§Œ ì…ë ¥ ê°€ëŠ¥

#### í—¬í¼ í•¨ìˆ˜
```sql
-- ì¡°íšŒìˆ˜ ì¦ê°€
increment_inquiry_view_count(inquiry_id UUID)

-- ë¯¸ë‹µë³€ ë¬¸ì˜ ê°œìˆ˜ (ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œìš©)
get_pending_inquiry_count() RETURNS BIGINT

-- ìƒí’ˆë³„ ë¬¸ì˜ ê°œìˆ˜ (ê³µê°œ ë¬¸ì˜ë§Œ)
get_product_inquiry_count(product_id UUID) RETURNS BIGINT
```

---

### 3. ëŒ“ê¸€/ì¢‹ì•„ìš” ì‹œìŠ¤í…œ (comments, likes)

#### comments í…Œì´ë¸” (ë‹¤í˜•ì„±)
```sql
comments (
  id UUID PRIMARY KEY,
  commentable_type VARCHAR(20),       -- 'review' | 'inquiry'
  commentable_id UUID,                -- ëŒ€ìƒ ID
  parent_id UUID,                     -- ëŒ€ëŒ“ê¸€ìš© (1ë‹¨ê³„ë§Œ í—ˆìš©)
  user_id UUID NOT NULL,
  content TEXT,
  like_count INTEGER DEFAULT 0,       -- ì¢‹ì•„ìš” ìˆ˜ (ìºì‹œ)
  created_at, updated_at,

  -- ëŒ€ëŒ“ê¸€ 1ë‹¨ê³„ë§Œ í—ˆìš©
  CHECK (parent_id IS NULL OR (SELECT parent_id FROM comments WHERE id = parent_id) IS NULL)
)
```

#### likes í…Œì´ë¸” (ë‹¤í˜•ì„±)
```sql
likes (
  id UUID PRIMARY KEY,
  likeable_type VARCHAR(20),          -- 'review' | 'comment'
  likeable_id UUID,                   -- ëŒ€ìƒ ID
  user_id UUID NOT NULL,
  created_at,

  -- ì¤‘ë³µ ì¢‹ì•„ìš” ë°©ì§€
  UNIQUE (likeable_type, likeable_id, user_id)
)
```

#### í•µì‹¬ ì •ì±…
- âœ… **ë‹¤í˜•ì„± ì§€ì›**: reviews, inquiriesì— ê³µí†µ ëŒ“ê¸€ ì‹œìŠ¤í…œ ì ìš©
- âœ… **1ë‹¨ê³„ ëŒ€ëŒ“ê¸€**: CHECK ì œì•½ìœ¼ë¡œ ê¹Šì€ ì¤‘ì²© ë°©ì§€
- âœ… **ì¢‹ì•„ìš” ì¤‘ë³µ ë°©ì§€**: UNIQUE ì œì•½ìœ¼ë¡œ ë™ì¼ ì‚¬ìš©ìê°€ ë™ì¼ ëŒ€ìƒì— 1ë²ˆë§Œ ì¢‹ì•„ìš”
- âœ… **ìë™ ë™ê¸°í™”**: ì¢‹ì•„ìš” ì¶”ê°€/ì‚­ì œ ì‹œ like_count ìë™ ê°±ì‹  (íŠ¸ë¦¬ê±° 4ê°œ)
- âœ… **ë¹„ë°€ê¸€ ëŒ“ê¸€ ë³´í˜¸**: inquiryê°€ is_private = trueì¼ ë•Œ ëŒ“ê¸€ë„ ë³´í˜¸

#### í—¬í¼ í•¨ìˆ˜
```sql
-- ì¢‹ì•„ìš” í† ê¸€ (ì¶”ê°€/ì·¨ì†Œ)
toggle_like(likeable_type, likeable_id, user_id) RETURNS JSONB

-- ëŒ“ê¸€ íŠ¸ë¦¬ ì¡°íšŒ (ëŒ€ëŒ“ê¸€ í¬í•¨)
get_comment_tree(commentable_type, commentable_id) RETURNS TABLE

-- ì‚¬ìš©ì ì¢‹ì•„ìš” ì—¬ë¶€ í™•ì¸
check_user_liked(likeable_type, likeable_id, user_id) RETURNS BOOLEAN
```

---

## ğŸ”’ RLS ì •ì±… ìš”ì•½

### reviews (5ê°œ ì •ì±…)
1. âœ… ëˆ„êµ¬ë‚˜ ì¡°íšŒ ê°€ëŠ¥
2. âœ… êµ¬ë§¤ìë§Œ ì‘ì„± ê°€ëŠ¥ (order_item_id ê²€ì¦)
3. âœ… ë³¸ì¸ë§Œ ìˆ˜ì • ê°€ëŠ¥
4. âœ… ë³¸ì¸ë§Œ ì‚­ì œ ê°€ëŠ¥
5. âœ… ê´€ë¦¬ìëŠ” ëª¨ë“  í›„ê¸° ê´€ë¦¬ (ë² ìŠ¤íŠ¸ ì„ ì • ë“±)

### inquiries (5ê°œ ì •ì±…)
1. âœ… ê³µê°œ ë¬¸ì˜ëŠ” ëˆ„êµ¬ë‚˜ ì¡°íšŒ, ë¹„ë°€ê¸€ì€ ë³¸ì¸/ê´€ë¦¬ìë§Œ
2. âœ… ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì‘ì„± ê°€ëŠ¥
3. âœ… ë³¸ì¸ë§Œ ìˆ˜ì • ê°€ëŠ¥ (ë‹µë³€ ì „ì—ë§Œ)
4. âœ… ë³¸ì¸ë§Œ ì‚­ì œ ê°€ëŠ¥ (ë‹µë³€ ì „ì—ë§Œ)
5. âœ… ê´€ë¦¬ìëŠ” ëª¨ë“  ë¬¸ì˜ ê´€ë¦¬ ë° ë‹µë³€

### comments (5ê°œ ì •ì±…)
1. âœ… ê³µê°œ ì½˜í…ì¸ ì˜ ëŒ“ê¸€ì€ ëˆ„êµ¬ë‚˜ ì¡°íšŒ
2. âœ… ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ëŒ“ê¸€ ì‘ì„±
3. âœ… ë³¸ì¸ë§Œ ìˆ˜ì • ê°€ëŠ¥
4. âœ… ë³¸ì¸ë§Œ ì‚­ì œ ê°€ëŠ¥
5. âœ… ê´€ë¦¬ìëŠ” ëª¨ë“  ëŒ“ê¸€ ê´€ë¦¬

### likes (3ê°œ ì •ì±…)
1. âœ… ëˆ„êµ¬ë‚˜ ì¢‹ì•„ìš” ëª©ë¡ ì¡°íšŒ
2. âœ… ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì¢‹ì•„ìš” ì¶”ê°€
3. âœ… ë³¸ì¸ë§Œ ì¢‹ì•„ìš” ì·¨ì†Œ ê°€ëŠ¥

---

## ğŸš€ íŠ¸ë¦¬ê±° ëª©ë¡

### ìë™ ê°±ì‹  íŠ¸ë¦¬ê±° (3ê°œ)
1. `set_reviews_updated_at` - reviews.updated_at ìë™ ê°±ì‹ 
2. `set_inquiries_updated_at` - inquiries.updated_at ìë™ ê°±ì‹ 
3. `set_comments_updated_at` - comments.updated_at ìë™ ê°±ì‹ 

### ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íŠ¸ë¦¬ê±° (5ê°œ)
4. `on_inquiry_answered` - ë‹µë³€ ì‘ì„± ì‹œ status ìë™ 'answered'ë¡œ ë³€ê²½
5. `on_like_review_insert` - í›„ê¸° ì¢‹ì•„ìš” ì¶”ê°€ ì‹œ like_count ì¦ê°€
6. `on_like_review_delete` - í›„ê¸° ì¢‹ì•„ìš” ì·¨ì†Œ ì‹œ like_count ê°ì†Œ
7. `on_like_comment_insert` - ëŒ“ê¸€ ì¢‹ì•„ìš” ì¶”ê°€ ì‹œ like_count ì¦ê°€
8. `on_like_comment_delete` - ëŒ“ê¸€ ì¢‹ì•„ìš” ì·¨ì†Œ ì‹œ like_count ê°ì†Œ

---

## ğŸ“Š ì¸ë±ìŠ¤ ìµœì í™”

### reviews (7ê°œ ì¸ë±ìŠ¤)
- `idx_reviews_product_id` - ìƒí’ˆë³„ í›„ê¸° ì¡°íšŒ
- `idx_reviews_user_id` - ì‚¬ìš©ìë³„ í›„ê¸°
- `idx_reviews_order_item_id` - êµ¬ë§¤ ê²€ì¦ (UNIQUE)
- `idx_reviews_rating` - ë³„ì  í•„í„°ë§
- `idx_reviews_is_best` - ë² ìŠ¤íŠ¸ í›„ê¸° (ì¡°ê±´ë¶€)
- `idx_reviews_created_at` - ìµœì‹ ìˆœ ì •ë ¬
- `idx_reviews_like_count` - ì¢‹ì•„ìš”ìˆœ ì •ë ¬

### inquiries (7ê°œ ì¸ë±ìŠ¤)
- `idx_inquiries_product_id` - ìƒí’ˆë³„ ë¬¸ì˜ (ì¡°ê±´ë¶€)
- `idx_inquiries_user_id` - ì‚¬ìš©ìë³„ ë¬¸ì˜
- `idx_inquiries_status` - ìƒíƒœë³„ í•„í„°ë§
- `idx_inquiries_category` - ì¹´í…Œê³ ë¦¬ë³„ í•„í„°ë§
- `idx_inquiries_created_at` - ìµœì‹ ìˆœ ì •ë ¬
- `idx_inquiries_is_private` - ë¹„ë°€ê¸€ í•„í„°ë§
- `idx_inquiries_answered_by` - ë‹µë³€ìë³„ í†µê³„ (ì¡°ê±´ë¶€)

### comments (5ê°œ ì¸ë±ìŠ¤)
- `idx_comments_commentable` - ë‹¤í˜•ì„± ì¡°íšŒ ìµœì í™”
- `idx_comments_parent_id` - ëŒ€ëŒ“ê¸€ ì¡°íšŒ (ì¡°ê±´ë¶€)
- `idx_comments_user_id` - ì‚¬ìš©ìë³„ ëŒ“ê¸€
- `idx_comments_created_at` - ìµœì‹ ìˆœ ì •ë ¬
- `idx_comments_like_count` - ì¢‹ì•„ìš”ìˆœ ì •ë ¬

### likes (3ê°œ ì¸ë±ìŠ¤)
- `idx_likes_likeable` - ë‹¤í˜•ì„± ì¡°íšŒ ìµœì í™”
- `idx_likes_user_id` - ì‚¬ìš©ìë³„ ì¢‹ì•„ìš”
- `idx_likes_created_at` - ìµœì‹ ìˆœ ì •ë ¬

---

## âœ… Acceptance Criteria ê²€ì¦

### AC1: í›„ê¸°ëŠ” êµ¬ë§¤ìë§Œ ì‘ì„± ê°€ëŠ¥ (order_item_id ê²€ì¦)
```sql
-- RLS ì •ì±…ì—ì„œ ê²€ì¦
CREATE POLICY "Purchasers can create reviews"
ON reviews FOR INSERT
WITH CHECK (
  auth.uid() = user_id
  AND EXISTS (
    SELECT 1 FROM order_items oi
    JOIN orders o ON oi.order_id = o.id
    WHERE oi.id = order_item_id
    AND o.user_id = auth.uid()
    AND o.status IN ('paid', 'completed')
  )
);
```
âœ… **PASS** - order_item_id FKì™€ RLS ì •ì±…ìœ¼ë¡œ êµ¬ë§¤ ê²€ì¦ ì™„ë£Œ

### AC2: ë¹„ë°€ ë¬¸ì˜ëŠ” ì‘ì„±ì/ê´€ë¦¬ìë§Œ ì¡°íšŒ
```sql
CREATE POLICY "Anyone can view public inquiries"
ON inquiries FOR SELECT
USING (
  is_private = false
  OR user_id = auth.uid()
  OR EXISTS (
    SELECT 1 FROM profiles
    WHERE id = auth.uid() AND role = 'admin'
  )
);
```
âœ… **PASS** - is_private í”Œë˜ê·¸ì™€ RLS ì •ì±…ìœ¼ë¡œ ì ‘ê·¼ ì œì–´ ì™„ë£Œ

### AC3: ì¢‹ì•„ìš” ì¤‘ë³µ ë°©ì§€ (UNIQUE ì œì•½)
```sql
-- likes í…Œì´ë¸” UNIQUE ì œì•½
CONSTRAINT likes_unique_user_likeable UNIQUE (likeable_type, likeable_id, user_id)
```
âœ… **PASS** - ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ ì œì•½ìœ¼ë¡œ ì¤‘ë³µ ë°©ì§€ ì™„ë£Œ

---

## ğŸ“ Lessons Learned

### 1. ë‹¤í˜•ì„± í…Œì´ë¸” ì„¤ê³„
- `commentable_type` + `commentable_id` íŒ¨í„´ìœ¼ë¡œ ì—¬ëŸ¬ ì—”í‹°í‹°ì— ê³µí†µ ì ìš©
- ë³µí•© ì¸ë±ìŠ¤ `(type, id)`ë¡œ ì¿¼ë¦¬ ì„±ëŠ¥ ë³´ì¥

### 2. ì¢‹ì•„ìš” ìˆ˜ ìºì‹œ ì „ëµ
- `like_count` ì»¬ëŸ¼ìœ¼ë¡œ ìºì‹±í•˜ì—¬ COUNT ì¿¼ë¦¬ ë¶€í•˜ ê°ì†Œ
- íŠ¸ë¦¬ê±°ë¡œ ìë™ ë™ê¸°í™”í•˜ì—¬ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- `GREATEST(like_count - 1, 0)`ìœ¼ë¡œ ìŒìˆ˜ ë°©ì§€

### 3. ë³´ì•ˆ ì„¤ê³„ íŒ¨í„´
- RLS ì •ì±…ì„ ì—¬ëŸ¬ ë ˆë²¨ë¡œ ë¶„ë¦¬ (ì¡°íšŒ/ì‘ì„±/ìˆ˜ì •/ì‚­ì œ)
- `SECURITY DEFINER` í•¨ìˆ˜ë¡œ RLS ìš°íšŒê°€ í•„ìš”í•œ ê²½ìš°ë§Œ ì„ ë³„ì  ì ìš©
- ë¹„ë°€ê¸€ ëŒ“ê¸€ê¹Œì§€ ì—°ì‡„ ë³´í˜¸ (parent content privacy check)

### 4. ëŒ€ëŒ“ê¸€ ê¹Šì´ ì œí•œ
- CHECK ì œì•½ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ì—ì„œ ê°•ì œ
- ì„±ëŠ¥ê³¼ UI ë³µì¡ë„ ì ˆì¶©ì 

### 5. ìë™í™” íŠ¸ë¦¬ê±° í™œìš©
- ë‹µë³€ ì‘ì„± ì‹œ status ìë™ ë³€ê²½
- ì¢‹ì•„ìš” ìˆ˜ ì‹¤ì‹œê°„ ë™ê¸°í™”
- updated_at ìë™ ê°±ì‹ 

---

## ğŸ“¦ ë‹¤ìŒ ë‹¨ê³„

### P6-T6.2: í›„ê¸° API êµ¬í˜„
- `POST /api/reviews` - í›„ê¸° ì‘ì„± (ì´ë¯¸ì§€ ì—…ë¡œë“œ í¬í•¨)
- `GET /api/products/[slug]/reviews` - ìƒí’ˆë³„ í›„ê¸° ëª©ë¡
- `PATCH /api/reviews/[id]` - í›„ê¸° ìˆ˜ì •
- `DELETE /api/reviews/[id]` - í›„ê¸° ì‚­ì œ

### P6-T6.3: ë¬¸ì˜ API êµ¬í˜„
- `POST /api/inquiries` - ë¬¸ì˜ ì‘ì„±
- `GET /api/inquiries` - ë¬¸ì˜ ëª©ë¡ (ë¹„ë°€ê¸€ í•„í„°ë§)
- `PATCH /api/inquiries/[id]` - ë¬¸ì˜ ìˆ˜ì •/ë‹µë³€
- `DELETE /api/inquiries/[id]` - ë¬¸ì˜ ì‚­ì œ

### P6-T6.4: ëŒ“ê¸€ API êµ¬í˜„
- `POST /api/comments` - ëŒ“ê¸€/ëŒ€ëŒ“ê¸€ ì‘ì„±
- `GET /api/comments?commentable_type=review&commentable_id={id}` - ëŒ“ê¸€ ëª©ë¡
- `PATCH /api/comments/[id]` - ëŒ“ê¸€ ìˆ˜ì •
- `DELETE /api/comments/[id]` - ëŒ“ê¸€ ì‚­ì œ

### P6-T6.5: ì¢‹ì•„ìš” API êµ¬í˜„
- `POST /api/likes` - ì¢‹ì•„ìš” í† ê¸€
- `GET /api/likes/check?likeable_type=review&likeable_id={id}` - ì¢‹ì•„ìš” ìƒíƒœ í™•ì¸

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ (API êµ¬í˜„ ì‹œ ì°¸ê³ )

### í›„ê¸° ì‘ì„± í”Œë¡œìš°
1. ì‚¬ìš©ìê°€ êµ¬ë§¤í•œ ìƒí’ˆ í™•ì¸ (order_items ì¡°íšŒ)
2. í›„ê¸° ì‘ì„± í¼ ì œì¶œ (rating, title, content, images)
3. RLS ì •ì±… ê²€ì¦ (êµ¬ë§¤ ì—¬ë¶€ í™•ì¸)
4. ì´ë¯¸ì§€ ì—…ë¡œë“œ (Supabase Storage)
5. í›„ê¸° ì €ì¥ (images JSONBì— URL ë°°ì—´ ì €ì¥)
6. âœ… ì„±ê³µ â†’ ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

### ë¹„ë°€ ë¬¸ì˜ ì¡°íšŒ í”Œë¡œìš°
1. ë¬¸ì˜ ëª©ë¡ API í˜¸ì¶œ
2. RLS ì •ì±… ì ìš© (is_private = false OR ë³¸ì¸ OR ê´€ë¦¬ì)
3. ë¹„ë°€ê¸€ ì•„ì´ì½˜ í‘œì‹œ (UI)
4. í´ë¦­ ì‹œ ê¶Œí•œ í™•ì¸
5. âœ… ê¶Œí•œ ìˆìŒ â†’ ìƒì„¸ ì¡°íšŒ
6. âŒ ê¶Œí•œ ì—†ìŒ â†’ 403 Forbidden

### ì¢‹ì•„ìš” í† ê¸€ í”Œë¡œìš°
1. ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­
2. `toggle_like()` í•¨ìˆ˜ í˜¸ì¶œ
3. ê¸°ì¡´ ì¢‹ì•„ìš” í™•ì¸ (SELECT)
4. ìˆìœ¼ë©´ DELETE, ì—†ìœ¼ë©´ INSERT
5. íŠ¸ë¦¬ê±° ìë™ ì‹¤í–‰ (like_count ê°±ì‹ )
6. âœ… UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (ë‚™ê´€ì  UI)

---

## ğŸ ìµœì¢… ìƒíƒœ

**Status**: âœ… **COMPLETED**

ëª¨ë“  ACë¥¼ ì¶©ì¡±í•˜ëŠ” 3ê°œì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„± ì™„ë£Œ:
- 008_create_reviews.sql (187 lines)
- 009_create_inquiries.sql (224 lines)
- 010_create_comments_likes.sql (366 lines)

**Total**: 777 lines of SQL

**ì‘ì—… ì™„ë£Œ ì‹œê°„**: 2026-01-25 16:34 UTC

---

**Signed-off by**: database-specialist (Claude Sonnet 4.5)
