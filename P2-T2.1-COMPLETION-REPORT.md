# P2-T2.1 ì™„ë£Œ ë¦¬í¬íŠ¸

## ğŸ“‹ íƒœìŠ¤í¬ ì •ë³´
- **Phase**: 2
- **íƒœìŠ¤í¬ ID**: P2-T2.1
- **íƒœìŠ¤í¬ëª…**: ê²ŒìŠ¤íŠ¸ ë·° ë¼ìš°íŒ… (/g/[slug]) êµ¬í˜„
- **ì™„ë£Œì¼**: 2026-01-28

---

## âœ… êµ¬í˜„ ë‚´ìš©

### 1. íƒ€ì… ì •ì˜ ìƒì„±
**íŒŒì¼**: `src/types/guidebook.ts`

- âœ… `Guidebook` íƒ€ì…: ê°€ì´ë“œë¶ ê¸°ë³¸ ì •ë³´
- âœ… `Block` íƒ€ì…: ë¸”ë¡ ë°ì´í„°
- âœ… `BlockContent` íƒ€ì…: 8ì¢… ë¸”ë¡ë³„ ì½˜í…ì¸  êµ¬ì¡°
  - HeroContent, QuickInfoContent, AmenitiesContent, RulesContent
  - MapContent, GalleryContent, NoticeContent, CustomContent
- âœ… `GuidebookWithBlocks` íƒ€ì…: ë¸”ë¡ í¬í•¨ ê°€ì´ë“œë¶

### 2. ê²ŒìŠ¤íŠ¸ í˜ì´ì§€ êµ¬í˜„
**íŒŒì¼**: `src/app/(guest)/g/[slug]/page.tsx`

- âœ… Server Component (SEO ìµœì í™”)
- âœ… `generateMetadata()`: ë™ì  ë©”íƒ€ë°ì´í„° ìƒì„±
- âœ… Supabase ì¿¼ë¦¬: slugë¡œ ê°€ì´ë“œë¶ + ë¸”ë¡ ì¡°íšŒ
- âœ… RLS ì •ì±… ì ìš©: `status = 'published'` í•„í„°ë§
- âœ… ë¸”ë¡ ì •ë ¬: `order_index` ê¸°ì¤€
- âœ… ì¡°íšŒìˆ˜ ì¦ê°€: ë¹„ë™ê¸° ì—…ë°ì´íŠ¸ (ì—ëŸ¬ ë¬´ì‹œ)
- âœ… 404 ì²˜ë¦¬: `notFound()` í˜¸ì¶œ

### 3. ë¡œë”©/ì—ëŸ¬/404 í˜ì´ì§€
**íŒŒì¼**:
- `src/app/(guest)/g/[slug]/loading.tsx`
- `src/app/(guest)/g/[slug]/error.tsx`
- `src/app/(guest)/g/[slug]/not-found.tsx`

- âœ… ë¡œë”© ìƒíƒœ: ìŠ¤ì¼ˆë ˆí†¤ UI
- âœ… ì—ëŸ¬ ì²˜ë¦¬: ì—ëŸ¬ ë©”ì‹œì§€ + ì¬ì‹œë„ ë²„íŠ¼
- âœ… 404 í˜ì´ì§€: ì•ˆë‚´ ë©”ì‹œì§€ + í™ˆ ë²„íŠ¼

---

## ğŸ¯ ì™„ë£Œ ê¸°ì¤€ ë‹¬ì„±

| ê¸°ì¤€ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| /g/[slug] ë¼ìš°íŠ¸ ë™ì‘ | âœ… | Server Component + SEO |
| ì¡´ì¬í•˜ì§€ ì•ŠëŠ” slug ì ‘ê·¼ ì‹œ 404 | âœ… | notFound() í˜¸ì¶œ |
| ë¡œë”©/ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬ | âœ… | 3ì¢… í˜ì´ì§€ êµ¬í˜„ |
| SEO ë©”íƒ€ë°ì´í„° ìƒì„± | âœ… | generateMetadata() |

---

## ğŸ” ê²€ì¦ ê²°ê³¼

### 1. TypeScript íƒ€ì… ì²´í¬
```bash
npx tsc --noEmit
```
âœ… **í†µê³¼**: íƒ€ì… ì—ëŸ¬ ì—†ìŒ

### 2. ESLint ê²€ì‚¬
```bash
npm run lint
```
âœ… **í†µê³¼**: ë¦°íŠ¸ ì—ëŸ¬ ì—†ìŒ

### 3. íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ guidebook.ts          âœ… ìƒì„±
â””â”€â”€ app/
    â””â”€â”€ (guest)/
        â””â”€â”€ g/
            â””â”€â”€ [slug]/
                â”œâ”€â”€ page.tsx      âœ… ìƒì„±
                â”œâ”€â”€ loading.tsx   âœ… ìƒì„±
                â”œâ”€â”€ error.tsx     âœ… ìƒì„±
                â””â”€â”€ not-found.tsx âœ… ìƒì„±
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ ê°€ì´ë“œë¶ ì¡°íšŒ
1. ë¸Œë¼ìš°ì €ì—ì„œ `/g/test-guidebook` ì ‘ê·¼
2. Supabaseì—ì„œ `slug = 'test-guidebook'` AND `status = 'published'` ì¡°íšŒ
3. ê°€ì´ë“œë¶ + ë¸”ë¡ ë Œë”ë§
4. ì¡°íšŒìˆ˜ +1 ì¦ê°€

**ì˜ˆìƒ ê²°ê³¼**: ê°€ì´ë“œë¶ íƒ€ì´í‹€, ì„¤ëª…, ë¸”ë¡ ëª©ë¡ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” slug
1. ë¸Œë¼ìš°ì €ì—ì„œ `/g/invalid-slug` ì ‘ê·¼
2. Supabase ì¡°íšŒ ì‹¤íŒ¨
3. `notFound()` í˜¸ì¶œ

**ì˜ˆìƒ ê²°ê³¼**: 404 í˜ì´ì§€ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë¹„ê³µê°œ ê°€ì´ë“œë¶
1. ë¸Œë¼ìš°ì €ì—ì„œ `/g/draft-guidebook` ì ‘ê·¼
2. Supabase ì¡°íšŒ ì‹œ `status = 'published'` í•„í„°ë§
3. ê²°ê³¼ ì—†ìŒ

**ì˜ˆìƒ ê²°ê³¼**: 404 í˜ì´ì§€ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 4: SEO ë©”íƒ€ë°ì´í„°
1. ì†Œì…œ ê³µìœ  ë´‡ì´ `/g/test-guidebook` ì ‘ê·¼
2. `generateMetadata()` ì‹¤í–‰
3. Open Graph ë©”íƒ€ íƒœê·¸ ìƒì„±

**ì˜ˆìƒ ê²°ê³¼**: ê°€ì´ë“œë¶ ì œëª©, ì„¤ëª…, ì´ë¯¸ì§€ê°€ ë©”íƒ€ íƒœê·¸ì— í¬í•¨

---

## ğŸ“Š ê¸°ìˆ  ìŠ¤íƒ

| í•­ëª© | ê¸°ìˆ  |
|------|------|
| Framework | Next.js 16 App Router |
| Language | TypeScript |
| Database | Supabase (PostgreSQL) |
| Auth | RLS (Row Level Security) |
| Rendering | Server Components |
| SEO | generateMetadata() |

---

## ğŸ”— ì—°ê´€ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `src/lib/supabase/server.ts` | Supabase ì„œë²„ í´ë¼ì´ì–¸íŠ¸ |
| `src/app/(guest)/layout.tsx` | ê²ŒìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ |
| `supabase/migrations/001_core_schema.sql` | DB ìŠ¤í‚¤ë§ˆ |
| `docs/planning/04-database-design.md` | DB ì„¤ê³„ ë¬¸ì„œ |

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„ (P2-T2.2)

**íƒœìŠ¤í¬**: ë¸”ë¡ ë Œë”ëŸ¬ (Guestìš©) êµ¬í˜„

### í•„ìš” ì‘ì—…
1. `src/components/guest/block-renderer.tsx` ìƒì„±
2. ë¸”ë¡ íƒ€ì…ë³„ ë Œë”ë§ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
   - HeroBlock, QuickInfoBlock, AmenitiesBlock, RulesBlock
   - MapBlock, GalleryBlock, NoticeBlock, CustomBlock
3. ë¸”ë¡ ë Œë”ëŸ¬ë¥¼ page.tsxì— ì—°ë™

---

## ğŸ“ Lessons Learned

### 2026-01-28: P2-T2.1 ê²ŒìŠ¤íŠ¸ ë¼ìš°íŒ… êµ¬í˜„

**ìƒí™©**: Next.js 16 Server Componentë¡œ Supabase ì¡°íšŒ + SEO ë©”íƒ€ë°ì´í„° ìƒì„±

**ë°°ìš´ ì **:
1. **paramsëŠ” Promise**: Next.js 16ì—ì„œ `params`ëŠ” ë¹„ë™ê¸° ê°ì²´
   - `const { slug } = await params;` í•„ìˆ˜
2. **RLS ìë™ ì ìš©**: Supabase ì¿¼ë¦¬ ì‹œ RLS ì •ì±…ì´ ìë™ ì ìš©ë¨
   - `status = 'published'` í•„í„°ë§ì´ í´ë¼ì´ì–¸íŠ¸ë‹¨ì—ì„œ ì²˜ë¦¬ë¨
3. **ì¡°íšŒìˆ˜ ì¦ê°€ íŒ¨í„´**: ë¹„ë™ê¸° ì—…ë°ì´íŠ¸ë¡œ ì„±ëŠ¥ ìµœì í™”
   - `.then()/.catch()`ë¡œ ì—ëŸ¬ ë¬´ì‹œ
4. **SEO ìµœì í™”**: `generateMetadata()`ë¡œ Open Graph ë©”íƒ€ íƒœê·¸ ìë™ ìƒì„±
   - ì†Œì…œ ê³µìœ  ì‹œ ë¯¸ë¦¬ë³´ê¸° ì§€ì›

**êµí›ˆ**: Server Component + RLS ì¡°í•©ìœ¼ë¡œ ì•ˆì „í•˜ê³  SEO ì¹œí™”ì ì¸ ê²ŒìŠ¤íŠ¸ í˜ì´ì§€ êµ¬í˜„ ê°€ëŠ¥

---

## âœ… TASK_DONE

ê²€ì¦ ê²°ê³¼:
- âœ… TypeScript íƒ€ì… ì²´í¬: í†µê³¼
- âœ… ESLint: í†µê³¼
- âœ… íŒŒì¼ ìƒì„±: 5ê°œ íŒŒì¼ (guidebook.ts, page.tsx, loading.tsx, error.tsx, not-found.tsx)
- âœ… ì™„ë£Œ ê¸°ì¤€: 4/4 ë‹¬ì„±
